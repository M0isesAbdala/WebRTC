import{createRequire as x7}from"node:module";var U7=Object.create;var{getPrototypeOf:q7,defineProperty:r5,getOwnPropertyNames:T7}=Object;var L7=Object.prototype.hasOwnProperty;var o=(J,X,Z)=>{Z=J!=null?U7(q7(J)):{};let $=X||!J||!J.__esModule?r5(Z,"default",{value:J,enumerable:!0}):Z;for(let K of T7(J))if(!L7.call($,K))r5($,K,{get:()=>J[K],enumerable:!0});return $};var F=(J,X)=>()=>(X||J((X={exports:{}}).exports,X),X.exports);var N=x7(import.meta.url);var T=F((YX,s5)=>{var a5=["nodebuffer","arraybuffer","fragments"],o5=typeof Blob!=="undefined";if(o5)a5.push("blob");s5.exports={BINARY_TYPES:a5,EMPTY_BUFFER:Buffer.alloc(0),GUID:"258EAFA5-E914-47DA-95CA-C5AB0DC85B11",hasBlob:o5,kForOnEventAttribute:Symbol("kIsForOnEventAttribute"),kListener:Symbol("kListener"),kStatusCode:Symbol("status-code"),kWebSocket:Symbol("websocket"),NOOP:()=>{}}});var H4=F((VX,_4)=>{var X4=N("fs"),L=N("path"),Z4=N("os"),$4=typeof __webpack_require__==="function"?__non_webpack_require__:N,W7=process.config&&process.config.variables||{},y7=!!process.env.PREBUILDS_ONLY,t5=process.versions.modules,M5=v7()?"electron":S7()?"node-webkit":"node",O5=process.env.npm_config_arch||Z4.arch(),P5=process.env.npm_config_platform||Z4.platform(),K4=process.env.LIBC||(w7(P5)?"musl":"glibc"),B5=process.env.ARM_VERSION||(O5==="arm64"?"8":W7.arm_version)||"",G4=(process.versions.uv||"").split(".")[0];_4.exports=U;function U(J){return $4(U.resolve(J))}U.resolve=U.path=function(J){J=L.resolve(J||".");try{var X=$4(L.join(J,"package.json")).name.toUpperCase().replace(/-/g,"_");if(process.env[X+"_PREBUILD"])J=process.env[X+"_PREBUILD"]}catch(Q){}if(!y7){var Z=e5(L.join(J,"build/Release"),J4);if(Z)return Z;var $=e5(L.join(J,"build/Debug"),J4);if($)return $}var K=j(J);if(K)return K;var G=j(L.dirname(process.execPath));if(G)return G;var z=["platform="+P5,"arch="+O5,"runtime="+M5,"abi="+t5,"uv="+G4,B5?"armv="+B5:"","libc="+K4,"node="+process.versions.node,process.versions.electron?"electron="+process.versions.electron:"",typeof __webpack_require__==="function"?"webpack=true":""].filter(Boolean).join(" ");throw new Error("No native build was found for "+z+`
    loaded from: `+J+`
`);function j(Q){var I=C5(L.join(Q,"prebuilds")).map(Q4),_=I.filter(z4(P5,O5)).sort(j4)[0];if(!_)return;var Y=L.join(Q,"prebuilds",_.name),A=C5(Y).map(Y4),M=A.filter(V4(M5,t5)),R=M.sort(I4(M5))[0];if(R)return L.join(Y,R.file)}};function C5(J){try{return X4.readdirSync(J)}catch(X){return[]}}function e5(J,X){var Z=C5(J).filter(X);return Z[0]&&L.join(J,Z[0])}function J4(J){return/\.node$/.test(J)}function Q4(J){var X=J.split("-");if(X.length!==2)return;var Z=X[0],$=X[1].split("+");if(!Z)return;if(!$.length)return;if(!$.every(Boolean))return;return{name:J,platform:Z,architectures:$}}function z4(J,X){return function(Z){if(Z==null)return!1;if(Z.platform!==J)return!1;return Z.architectures.includes(X)}}function j4(J,X){return J.architectures.length-X.architectures.length}function Y4(J){var X=J.split("."),Z=X.pop(),$={file:J,specificity:0};if(Z!=="node")return;for(var K=0;K<X.length;K++){var G=X[K];if(G==="node"||G==="electron"||G==="node-webkit")$.runtime=G;else if(G==="napi")$.napi=!0;else if(G.slice(0,3)==="abi")$.abi=G.slice(3);else if(G.slice(0,2)==="uv")$.uv=G.slice(2);else if(G.slice(0,4)==="armv")$.armv=G.slice(4);else if(G==="glibc"||G==="musl")$.libc=G;else continue;$.specificity++}return $}function V4(J,X){return function(Z){if(Z==null)return!1;if(Z.runtime&&Z.runtime!==J&&!E7(Z))return!1;if(Z.abi&&Z.abi!==X&&!Z.napi)return!1;if(Z.uv&&Z.uv!==G4)return!1;if(Z.armv&&Z.armv!==B5)return!1;if(Z.libc&&Z.libc!==K4)return!1;return!0}}function E7(J){return J.runtime==="node"&&J.napi}function I4(J){return function(X,Z){if(X.runtime!==Z.runtime)return X.runtime===J?-1:1;else if(X.abi!==Z.abi)return X.abi?-1:1;else if(X.specificity!==Z.specificity)return X.specificity>Z.specificity?-1:1;else return 0}}function S7(){return!!(process.versions&&process.versions.nw)}function v7(){if(process.versions&&process.versions.electron)return!0;if(process.env.ELECTRON_RUN_AS_NODE)return!0;return typeof window!=="undefined"&&window.process&&window.process.type==="renderer"}function w7(J){return J==="linux"&&X4.existsSync("/etc/alpine-release")}U.parseTags=Y4;U.matchTags=V4;U.compareTags=I4;U.parseTuple=Q4;U.matchTuple=z4;U.compareTuples=j4});var T5=F((_X,q5)=>{var U5=typeof __webpack_require__==="function"?__non_webpack_require__:N;if(typeof U5.addon==="function")q5.exports=U5.addon.bind(U5);else q5.exports=H4()});var R4=F((NX,N4)=>{var h7=(J,X,Z,$,K)=>{for(var G=0;G<K;G++)Z[$+G]=J[G]^X[G&3]},g7=(J,X)=>{let Z=J.length;for(var $=0;$<Z;$++)J[$]^=X[$&3]};N4.exports={mask:h7,unmask:g7}});var A4=F((RX,L5)=>{var __dirname="C:\\Users\\desen\\OneDrive\\Área de Trabalho\\WebRTC\\node_modules\\bufferutil";try{L5.exports=T5()(__dirname)}catch(J){L5.exports=R4()}});var s=F((AX,G5)=>{var{EMPTY_BUFFER:m7}=T(),x5=Buffer[Symbol.species];function f7(J,X){if(J.length===0)return m7;if(J.length===1)return J[0];let Z=Buffer.allocUnsafe(X),$=0;for(let K=0;K<J.length;K++){let G=J[K];Z.set(G,$),$+=G.length}if($<X)return new x5(Z.buffer,Z.byteOffset,$);return Z}function F4(J,X,Z,$,K){for(let G=0;G<K;G++)Z[$+G]=J[G]^X[G&3]}function D4(J,X){for(let Z=0;Z<J.length;Z++)J[Z]^=X[Z&3]}function u7(J){if(J.length===J.buffer.byteLength)return J.buffer;return J.buffer.slice(J.byteOffset,J.byteOffset+J.length)}function W5(J){if(W5.readOnly=!0,Buffer.isBuffer(J))return J;let X;if(J instanceof ArrayBuffer)X=new x5(J);else if(ArrayBuffer.isView(J))X=new x5(J.buffer,J.byteOffset,J.byteLength);else X=Buffer.from(J),W5.readOnly=!1;return X}G5.exports={concat:f7,mask:F4,toArrayBuffer:u7,toBuffer:W5,unmask:D4};if(!process.env.WS_NO_BUFFER_UTIL)try{let J=A4();G5.exports.mask=function(X,Z,$,K,G){if(G<48)F4(X,Z,$,K,G);else J.mask(X,Z,$,K,G)},G5.exports.unmask=function(X,Z){if(X.length<32)D4(X,Z);else J.unmask(X,Z)}}catch(J){}});var B4=F((FX,P4)=>{var M4=Symbol("kDone"),y5=Symbol("kRun");class O4{constructor(J){this[M4]=()=>{this.pending--,this[y5]()},this.concurrency=J||1/0,this.jobs=[],this.pending=0}add(J){this.jobs.push(J),this[y5]()}[y5](){if(this.pending===this.concurrency)return;if(this.jobs.length){let J=this.jobs.shift();this.pending++,J(this[M4])}}}P4.exports=O4});var e=F((DX,L4)=>{var t=N("zlib"),C4=s(),l7=B4(),{kStatusCode:U4}=T(),p7=Buffer[Symbol.species],k7=Buffer.from([0,0,255,255]),z5=Symbol("permessage-deflate"),x=Symbol("total-length"),p=Symbol("callback"),y=Symbol("buffers"),k=Symbol("error"),Q5;class q4{constructor(J,X,Z){if(this._maxPayload=Z|0,this._options=J||{},this._threshold=this._options.threshold!==void 0?this._options.threshold:1024,this._isServer=!!X,this._deflate=null,this._inflate=null,this.params=null,!Q5){let $=this._options.concurrencyLimit!==void 0?this._options.concurrencyLimit:10;Q5=new l7($)}}static get extensionName(){return"permessage-deflate"}offer(){let J={};if(this._options.serverNoContextTakeover)J.server_no_context_takeover=!0;if(this._options.clientNoContextTakeover)J.client_no_context_takeover=!0;if(this._options.serverMaxWindowBits)J.server_max_window_bits=this._options.serverMaxWindowBits;if(this._options.clientMaxWindowBits)J.client_max_window_bits=this._options.clientMaxWindowBits;else if(this._options.clientMaxWindowBits==null)J.client_max_window_bits=!0;return J}accept(J){return J=this.normalizeParams(J),this.params=this._isServer?this.acceptAsServer(J):this.acceptAsClient(J),this.params}cleanup(){if(this._inflate)this._inflate.close(),this._inflate=null;if(this._deflate){let J=this._deflate[p];if(this._deflate.close(),this._deflate=null,J)J(new Error("The deflate stream was closed while data was being processed"))}}acceptAsServer(J){let X=this._options,Z=J.find(($)=>{if(X.serverNoContextTakeover===!1&&$.server_no_context_takeover||$.server_max_window_bits&&(X.serverMaxWindowBits===!1||typeof X.serverMaxWindowBits==="number"&&X.serverMaxWindowBits>$.server_max_window_bits)||typeof X.clientMaxWindowBits==="number"&&!$.client_max_window_bits)return!1;return!0});if(!Z)throw new Error("None of the extension offers can be accepted");if(X.serverNoContextTakeover)Z.server_no_context_takeover=!0;if(X.clientNoContextTakeover)Z.client_no_context_takeover=!0;if(typeof X.serverMaxWindowBits==="number")Z.server_max_window_bits=X.serverMaxWindowBits;if(typeof X.clientMaxWindowBits==="number")Z.client_max_window_bits=X.clientMaxWindowBits;else if(Z.client_max_window_bits===!0||X.clientMaxWindowBits===!1)delete Z.client_max_window_bits;return Z}acceptAsClient(J){let X=J[0];if(this._options.clientNoContextTakeover===!1&&X.client_no_context_takeover)throw new Error('Unexpected parameter "client_no_context_takeover"');if(!X.client_max_window_bits){if(typeof this._options.clientMaxWindowBits==="number")X.client_max_window_bits=this._options.clientMaxWindowBits}else if(this._options.clientMaxWindowBits===!1||typeof this._options.clientMaxWindowBits==="number"&&X.client_max_window_bits>this._options.clientMaxWindowBits)throw new Error('Unexpected or invalid parameter "client_max_window_bits"');return X}normalizeParams(J){return J.forEach((X)=>{Object.keys(X).forEach((Z)=>{let $=X[Z];if($.length>1)throw new Error(`Parameter "${Z}" must have only a single value`);if($=$[0],Z==="client_max_window_bits"){if($!==!0){let K=+$;if(!Number.isInteger(K)||K<8||K>15)throw new TypeError(`Invalid value for parameter "${Z}": ${$}`);$=K}else if(!this._isServer)throw new TypeError(`Invalid value for parameter "${Z}": ${$}`)}else if(Z==="server_max_window_bits"){let K=+$;if(!Number.isInteger(K)||K<8||K>15)throw new TypeError(`Invalid value for parameter "${Z}": ${$}`);$=K}else if(Z==="client_no_context_takeover"||Z==="server_no_context_takeover"){if($!==!0)throw new TypeError(`Invalid value for parameter "${Z}": ${$}`)}else throw new Error(`Unknown parameter "${Z}"`);X[Z]=$})}),J}decompress(J,X,Z){Q5.add(($)=>{this._decompress(J,X,(K,G)=>{$(),Z(K,G)})})}compress(J,X,Z){Q5.add(($)=>{this._compress(J,X,(K,G)=>{$(),Z(K,G)})})}_decompress(J,X,Z){let $=this._isServer?"client":"server";if(!this._inflate){let K=`${$}_max_window_bits`,G=typeof this.params[K]!=="number"?t.Z_DEFAULT_WINDOWBITS:this.params[K];this._inflate=t.createInflateRaw({...this._options.zlibInflateOptions,windowBits:G}),this._inflate[z5]=this,this._inflate[x]=0,this._inflate[y]=[],this._inflate.on("error",d7),this._inflate.on("data",T4)}if(this._inflate[p]=Z,this._inflate.write(J),X)this._inflate.write(k7);this._inflate.flush(()=>{let K=this._inflate[k];if(K){this._inflate.close(),this._inflate=null,Z(K);return}let G=C4.concat(this._inflate[y],this._inflate[x]);if(this._inflate._readableState.endEmitted)this._inflate.close(),this._inflate=null;else if(this._inflate[x]=0,this._inflate[y]=[],X&&this.params[`${$}_no_context_takeover`])this._inflate.reset();Z(null,G)})}_compress(J,X,Z){let $=this._isServer?"server":"client";if(!this._deflate){let K=`${$}_max_window_bits`,G=typeof this.params[K]!=="number"?t.Z_DEFAULT_WINDOWBITS:this.params[K];this._deflate=t.createDeflateRaw({...this._options.zlibDeflateOptions,windowBits:G}),this._deflate[x]=0,this._deflate[y]=[],this._deflate.on("data",b7)}this._deflate[p]=Z,this._deflate.write(J),this._deflate.flush(t.Z_SYNC_FLUSH,()=>{if(!this._deflate)return;let K=C4.concat(this._deflate[y],this._deflate[x]);if(X)K=new p7(K.buffer,K.byteOffset,K.length-4);if(this._deflate[p]=null,this._deflate[x]=0,this._deflate[y]=[],X&&this.params[`${$}_no_context_takeover`])this._deflate.reset();Z(null,K)})}}L4.exports=q4;function b7(J){this[y].push(J),this[x]+=J.length}function T4(J){if(this[x]+=J.length,this[z5]._maxPayload<1||this[x]<=this[z5]._maxPayload){this[y].push(J);return}this[k]=new RangeError("Max payload size exceeded"),this[k].code="WS_ERR_UNSUPPORTED_MESSAGE_LENGTH",this[k][U4]=1009,this.removeListener("data",T4),this.reset()}function d7(J){if(this[z5]._inflate=null,this[k]){this[p](this[k]);return}J[U4]=1007,this[p](J)}});var W4=F((MX,x4)=>{function i7(J){let X=J.length,Z=0;while(Z<X)if((J[Z]&128)===0)Z++;else if((J[Z]&224)===192){if(Z+1===X||(J[Z+1]&192)!==128||(J[Z]&254)===192)return!1;Z+=2}else if((J[Z]&240)===224){if(Z+2>=X||(J[Z+1]&192)!==128||(J[Z+2]&192)!==128||J[Z]===224&&(J[Z+1]&224)===128||J[Z]===237&&(J[Z+1]&224)===160)return!1;Z+=3}else if((J[Z]&248)===240){if(Z+3>=X||(J[Z+1]&192)!==128||(J[Z+2]&192)!==128||(J[Z+3]&192)!==128||J[Z]===240&&(J[Z+1]&240)===128||J[Z]===244&&J[Z+1]>143||J[Z]>244)return!1;Z+=4}else return!1;return!0}x4.exports=i7});var y4=F((OX,E5)=>{var __dirname="C:\\Users\\desen\\OneDrive\\Área de Trabalho\\WebRTC\\node_modules\\utf-8-validate";try{E5.exports=T5()(__dirname)}catch(J){E5.exports=W4()}});var b=F((PX,j5)=>{var{isUtf8:E4}=N("buffer"),{hasBlob:c7}=T(),n7=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,1,1,1,0,0,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1,0];function r7(J){return J>=1000&&J<=1014&&J!==1004&&J!==1005&&J!==1006||J>=3000&&J<=4999}function S5(J){let X=J.length,Z=0;while(Z<X)if((J[Z]&128)===0)Z++;else if((J[Z]&224)===192){if(Z+1===X||(J[Z+1]&192)!==128||(J[Z]&254)===192)return!1;Z+=2}else if((J[Z]&240)===224){if(Z+2>=X||(J[Z+1]&192)!==128||(J[Z+2]&192)!==128||J[Z]===224&&(J[Z+1]&224)===128||J[Z]===237&&(J[Z+1]&224)===160)return!1;Z+=3}else if((J[Z]&248)===240){if(Z+3>=X||(J[Z+1]&192)!==128||(J[Z+2]&192)!==128||(J[Z+3]&192)!==128||J[Z]===240&&(J[Z+1]&240)===128||J[Z]===244&&J[Z+1]>143||J[Z]>244)return!1;Z+=4}else return!1;return!0}function a7(J){return c7&&typeof J==="object"&&typeof J.arrayBuffer==="function"&&typeof J.type==="string"&&typeof J.stream==="function"&&(J[Symbol.toStringTag]==="Blob"||J[Symbol.toStringTag]==="File")}j5.exports={isBlob:a7,isValidStatusCode:r7,isValidUTF8:S5,tokenChars:n7};if(E4)j5.exports.isValidUTF8=function(J){return J.length<24?S5(J):E4(J)};else if(!process.env.WS_NO_UTF_8_VALIDATE)try{let J=y4();j5.exports.isValidUTF8=function(X){return X.length<32?S5(X):J(X)}}catch(J){}});var w5=F((BX,g4)=>{var{Writable:o7}=N("stream"),S4=e(),{BINARY_TYPES:s7,EMPTY_BUFFER:v4,kStatusCode:t7,kWebSocket:e7}=T(),{concat:v5,toArrayBuffer:JJ,unmask:XJ}=s(),{isValidStatusCode:ZJ,isValidUTF8:w4}=b(),Y5=Buffer[Symbol.species];class h4 extends o7{constructor(J={}){super();this._allowSynchronousEvents=J.allowSynchronousEvents!==void 0?J.allowSynchronousEvents:!0,this._binaryType=J.binaryType||s7[0],this._extensions=J.extensions||{},this._isServer=!!J.isServer,this._maxPayload=J.maxPayload|0,this._skipUTF8Validation=!!J.skipUTF8Validation,this[e7]=void 0,this._bufferedBytes=0,this._buffers=[],this._compressed=!1,this._payloadLength=0,this._mask=void 0,this._fragmented=0,this._masked=!1,this._fin=!1,this._opcode=0,this._totalPayloadLength=0,this._messageLength=0,this._fragments=[],this._errored=!1,this._loop=!1,this._state=0}_write(J,X,Z){if(this._opcode===8&&this._state==0)return Z();this._bufferedBytes+=J.length,this._buffers.push(J),this.startLoop(Z)}consume(J){if(this._bufferedBytes-=J,J===this._buffers[0].length)return this._buffers.shift();if(J<this._buffers[0].length){let Z=this._buffers[0];return this._buffers[0]=new Y5(Z.buffer,Z.byteOffset+J,Z.length-J),new Y5(Z.buffer,Z.byteOffset,J)}let X=Buffer.allocUnsafe(J);do{let Z=this._buffers[0],$=X.length-J;if(J>=Z.length)X.set(this._buffers.shift(),$);else X.set(new Uint8Array(Z.buffer,Z.byteOffset,J),$),this._buffers[0]=new Y5(Z.buffer,Z.byteOffset+J,Z.length-J);J-=Z.length}while(J>0);return X}startLoop(J){this._loop=!0;do switch(this._state){case 0:this.getInfo(J);break;case 1:this.getPayloadLength16(J);break;case 2:this.getPayloadLength64(J);break;case 3:this.getMask();break;case 4:this.getData(J);break;case 5:case 6:this._loop=!1;return}while(this._loop);if(!this._errored)J()}getInfo(J){if(this._bufferedBytes<2){this._loop=!1;return}let X=this.consume(2);if((X[0]&48)!==0){let $=this.createError(RangeError,"RSV2 and RSV3 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_2_3");J($);return}let Z=(X[0]&64)===64;if(Z&&!this._extensions[S4.extensionName]){let $=this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");J($);return}if(this._fin=(X[0]&128)===128,this._opcode=X[0]&15,this._payloadLength=X[1]&127,this._opcode===0){if(Z){let $=this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");J($);return}if(!this._fragmented){let $=this.createError(RangeError,"invalid opcode 0",!0,1002,"WS_ERR_INVALID_OPCODE");J($);return}this._opcode=this._fragmented}else if(this._opcode===1||this._opcode===2){if(this._fragmented){let $=this.createError(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE");J($);return}this._compressed=Z}else if(this._opcode>7&&this._opcode<11){if(!this._fin){let $=this.createError(RangeError,"FIN must be set",!0,1002,"WS_ERR_EXPECTED_FIN");J($);return}if(Z){let $=this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");J($);return}if(this._payloadLength>125||this._opcode===8&&this._payloadLength===1){let $=this.createError(RangeError,`invalid payload length ${this._payloadLength}`,!0,1002,"WS_ERR_INVALID_CONTROL_PAYLOAD_LENGTH");J($);return}}else{let $=this.createError(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE");J($);return}if(!this._fin&&!this._fragmented)this._fragmented=this._opcode;if(this._masked=(X[1]&128)===128,this._isServer){if(!this._masked){let $=this.createError(RangeError,"MASK must be set",!0,1002,"WS_ERR_EXPECTED_MASK");J($);return}}else if(this._masked){let $=this.createError(RangeError,"MASK must be clear",!0,1002,"WS_ERR_UNEXPECTED_MASK");J($);return}if(this._payloadLength===126)this._state=1;else if(this._payloadLength===127)this._state=2;else this.haveLength(J)}getPayloadLength16(J){if(this._bufferedBytes<2){this._loop=!1;return}this._payloadLength=this.consume(2).readUInt16BE(0),this.haveLength(J)}getPayloadLength64(J){if(this._bufferedBytes<8){this._loop=!1;return}let X=this.consume(8),Z=X.readUInt32BE(0);if(Z>Math.pow(2,21)-1){let $=this.createError(RangeError,"Unsupported WebSocket frame: payload length > 2^53 - 1",!1,1009,"WS_ERR_UNSUPPORTED_DATA_PAYLOAD_LENGTH");J($);return}this._payloadLength=Z*Math.pow(2,32)+X.readUInt32BE(4),this.haveLength(J)}haveLength(J){if(this._payloadLength&&this._opcode<8){if(this._totalPayloadLength+=this._payloadLength,this._totalPayloadLength>this._maxPayload&&this._maxPayload>0){let X=this.createError(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH");J(X);return}}if(this._masked)this._state=3;else this._state=4}getMask(){if(this._bufferedBytes<4){this._loop=!1;return}this._mask=this.consume(4),this._state=4}getData(J){let X=v4;if(this._payloadLength){if(this._bufferedBytes<this._payloadLength){this._loop=!1;return}if(X=this.consume(this._payloadLength),this._masked&&(this._mask[0]|this._mask[1]|this._mask[2]|this._mask[3])!==0)XJ(X,this._mask)}if(this._opcode>7){this.controlMessage(X,J);return}if(this._compressed){this._state=5,this.decompress(X,J);return}if(X.length)this._messageLength=this._totalPayloadLength,this._fragments.push(X);this.dataMessage(J)}decompress(J,X){this._extensions[S4.extensionName].decompress(J,this._fin,($,K)=>{if($)return X($);if(K.length){if(this._messageLength+=K.length,this._messageLength>this._maxPayload&&this._maxPayload>0){let G=this.createError(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH");X(G);return}this._fragments.push(K)}if(this.dataMessage(X),this._state===0)this.startLoop(X)})}dataMessage(J){if(!this._fin){this._state=0;return}let X=this._messageLength,Z=this._fragments;if(this._totalPayloadLength=0,this._messageLength=0,this._fragmented=0,this._fragments=[],this._opcode===2){let $;if(this._binaryType==="nodebuffer")$=v5(Z,X);else if(this._binaryType==="arraybuffer")$=JJ(v5(Z,X));else if(this._binaryType==="blob")$=new Blob(Z);else $=Z;if(this._allowSynchronousEvents)this.emit("message",$,!0),this._state=0;else this._state=6,setImmediate(()=>{this.emit("message",$,!0),this._state=0,this.startLoop(J)})}else{let $=v5(Z,X);if(!this._skipUTF8Validation&&!w4($)){let K=this.createError(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8");J(K);return}if(this._state===5||this._allowSynchronousEvents)this.emit("message",$,!1),this._state=0;else this._state=6,setImmediate(()=>{this.emit("message",$,!1),this._state=0,this.startLoop(J)})}}controlMessage(J,X){if(this._opcode===8){if(J.length===0)this._loop=!1,this.emit("conclude",1005,v4),this.end();else{let Z=J.readUInt16BE(0);if(!ZJ(Z)){let K=this.createError(RangeError,`invalid status code ${Z}`,!0,1002,"WS_ERR_INVALID_CLOSE_CODE");X(K);return}let $=new Y5(J.buffer,J.byteOffset+2,J.length-2);if(!this._skipUTF8Validation&&!w4($)){let K=this.createError(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8");X(K);return}this._loop=!1,this.emit("conclude",Z,$),this.end()}this._state=0;return}if(this._allowSynchronousEvents)this.emit(this._opcode===9?"ping":"pong",J),this._state=0;else this._state=6,setImmediate(()=>{this.emit(this._opcode===9?"ping":"pong",J),this._state=0,this.startLoop(X)})}createError(J,X,Z,$,K){this._loop=!1,this._errored=!0;let G=new J(Z?`Invalid WebSocket frame: ${X}`:X);return Error.captureStackTrace(G,this.createError),G.code=K,G[t7]=$,G}}g4.exports=h4});var g5=F((UX,u4)=>{var{Duplex:CX}=N("stream"),{randomFillSync:$J}=N("crypto"),m4=e(),{EMPTY_BUFFER:KJ,kWebSocket:GJ,NOOP:QJ}=T(),{isBlob:d,isValidStatusCode:zJ}=b(),{mask:f4,toBuffer:w}=s(),B=Symbol("kByteLength"),jJ=Buffer.alloc(4),h,i=8192,C=0,YJ=1,VJ=2;class E{constructor(J,X,Z){if(this._extensions=X||{},Z)this._generateMask=Z,this._maskBuffer=Buffer.alloc(4);this._socket=J,this._firstFragment=!0,this._compress=!1,this._bufferedBytes=0,this._queue=[],this._state=C,this.onerror=QJ,this[GJ]=void 0}static frame(J,X){let Z,$=!1,K=2,G=!1;if(X.mask){if(Z=X.maskBuffer||jJ,X.generateMask)X.generateMask(Z);else{if(i===8192){if(h===void 0)h=Buffer.alloc(8192);$J(h,0,8192),i=0}Z[0]=h[i++],Z[1]=h[i++],Z[2]=h[i++],Z[3]=h[i++]}G=(Z[0]|Z[1]|Z[2]|Z[3])===0,K=6}let z;if(typeof J==="string")if((!X.mask||G)&&X[B]!==void 0)z=X[B];else J=Buffer.from(J),z=J.length;else z=J.length,$=X.mask&&X.readOnly&&!G;let j=z;if(z>=65536)K+=8,j=127;else if(z>125)K+=2,j=126;let Q=Buffer.allocUnsafe($?z+K:K);if(Q[0]=X.fin?X.opcode|128:X.opcode,X.rsv1)Q[0]|=64;if(Q[1]=j,j===126)Q.writeUInt16BE(z,2);else if(j===127)Q[2]=Q[3]=0,Q.writeUIntBE(z,4,6);if(!X.mask)return[Q,J];if(Q[1]|=128,Q[K-4]=Z[0],Q[K-3]=Z[1],Q[K-2]=Z[2],Q[K-1]=Z[3],G)return[Q,J];if($)return f4(J,Z,Q,K,z),[Q];return f4(J,Z,J,0,z),[Q,J]}close(J,X,Z,$){let K;if(J===void 0)K=KJ;else if(typeof J!=="number"||!zJ(J))throw new TypeError("First argument must be a valid error code number");else if(X===void 0||!X.length)K=Buffer.allocUnsafe(2),K.writeUInt16BE(J,0);else{let z=Buffer.byteLength(X);if(z>123)throw new RangeError("The message must not be greater than 123 bytes");if(K=Buffer.allocUnsafe(2+z),K.writeUInt16BE(J,0),typeof X==="string")K.write(X,2);else K.set(X,2)}let G={[B]:K.length,fin:!0,generateMask:this._generateMask,mask:Z,maskBuffer:this._maskBuffer,opcode:8,readOnly:!1,rsv1:!1};if(this._state!==C)this.enqueue([this.dispatch,K,!1,G,$]);else this.sendFrame(E.frame(K,G),$)}ping(J,X,Z){let $,K;if(typeof J==="string")$=Buffer.byteLength(J),K=!1;else if(d(J))$=J.size,K=!1;else J=w(J),$=J.length,K=w.readOnly;if($>125)throw new RangeError("The data size must not be greater than 125 bytes");let G={[B]:$,fin:!0,generateMask:this._generateMask,mask:X,maskBuffer:this._maskBuffer,opcode:9,readOnly:K,rsv1:!1};if(d(J))if(this._state!==C)this.enqueue([this.getBlobData,J,!1,G,Z]);else this.getBlobData(J,!1,G,Z);else if(this._state!==C)this.enqueue([this.dispatch,J,!1,G,Z]);else this.sendFrame(E.frame(J,G),Z)}pong(J,X,Z){let $,K;if(typeof J==="string")$=Buffer.byteLength(J),K=!1;else if(d(J))$=J.size,K=!1;else J=w(J),$=J.length,K=w.readOnly;if($>125)throw new RangeError("The data size must not be greater than 125 bytes");let G={[B]:$,fin:!0,generateMask:this._generateMask,mask:X,maskBuffer:this._maskBuffer,opcode:10,readOnly:K,rsv1:!1};if(d(J))if(this._state!==C)this.enqueue([this.getBlobData,J,!1,G,Z]);else this.getBlobData(J,!1,G,Z);else if(this._state!==C)this.enqueue([this.dispatch,J,!1,G,Z]);else this.sendFrame(E.frame(J,G),Z)}send(J,X,Z){let $=this._extensions[m4.extensionName],K=X.binary?2:1,G=X.compress,z,j;if(typeof J==="string")z=Buffer.byteLength(J),j=!1;else if(d(J))z=J.size,j=!1;else J=w(J),z=J.length,j=w.readOnly;if(this._firstFragment){if(this._firstFragment=!1,G&&$&&$.params[$._isServer?"server_no_context_takeover":"client_no_context_takeover"])G=z>=$._threshold;this._compress=G}else G=!1,K=0;if(X.fin)this._firstFragment=!0;let Q={[B]:z,fin:X.fin,generateMask:this._generateMask,mask:X.mask,maskBuffer:this._maskBuffer,opcode:K,readOnly:j,rsv1:G};if(d(J))if(this._state!==C)this.enqueue([this.getBlobData,J,this._compress,Q,Z]);else this.getBlobData(J,this._compress,Q,Z);else if(this._state!==C)this.enqueue([this.dispatch,J,this._compress,Q,Z]);else this.dispatch(J,this._compress,Q,Z)}getBlobData(J,X,Z,$){this._bufferedBytes+=Z[B],this._state=VJ,J.arrayBuffer().then((K)=>{if(this._socket.destroyed){let z=new Error("The socket was closed while the blob was being read");process.nextTick(h5,this,z,$);return}this._bufferedBytes-=Z[B];let G=w(K);if(!X)this._state=C,this.sendFrame(E.frame(G,Z),$),this.dequeue();else this.dispatch(G,X,Z,$)}).catch((K)=>{process.nextTick(IJ,this,K,$)})}dispatch(J,X,Z,$){if(!X){this.sendFrame(E.frame(J,Z),$);return}let K=this._extensions[m4.extensionName];this._bufferedBytes+=Z[B],this._state=YJ,K.compress(J,Z.fin,(G,z)=>{if(this._socket.destroyed){let j=new Error("The socket was closed while data was being compressed");h5(this,j,$);return}this._bufferedBytes-=Z[B],this._state=C,Z.readOnly=!1,this.sendFrame(E.frame(z,Z),$),this.dequeue()})}dequeue(){while(this._state===C&&this._queue.length){let J=this._queue.shift();this._bufferedBytes-=J[3][B],Reflect.apply(J[0],this,J.slice(1))}}enqueue(J){this._bufferedBytes+=J[3][B],this._queue.push(J)}sendFrame(J,X){if(J.length===2)this._socket.cork(),this._socket.write(J[0]),this._socket.write(J[1],X),this._socket.uncork();else this._socket.write(J[0],X)}}u4.exports=E;function h5(J,X,Z){if(typeof Z==="function")Z(X);for(let $=0;$<J._queue.length;$++){let K=J._queue[$],G=K[K.length-1];if(typeof G==="function")G(X)}}function IJ(J,X,Z){h5(J,X,Z),J.onerror(X)}});var r4=F((qX,n4)=>{var{kForOnEventAttribute:J5,kListener:m5}=T(),l4=Symbol("kCode"),p4=Symbol("kData"),k4=Symbol("kError"),b4=Symbol("kMessage"),d4=Symbol("kReason"),c=Symbol("kTarget"),i4=Symbol("kType"),c4=Symbol("kWasClean");class S{constructor(J){this[c]=null,this[i4]=J}get target(){return this[c]}get type(){return this[i4]}}Object.defineProperty(S.prototype,"target",{enumerable:!0});Object.defineProperty(S.prototype,"type",{enumerable:!0});class n extends S{constructor(J,X={}){super(J);this[l4]=X.code===void 0?0:X.code,this[d4]=X.reason===void 0?"":X.reason,this[c4]=X.wasClean===void 0?!1:X.wasClean}get code(){return this[l4]}get reason(){return this[d4]}get wasClean(){return this[c4]}}Object.defineProperty(n.prototype,"code",{enumerable:!0});Object.defineProperty(n.prototype,"reason",{enumerable:!0});Object.defineProperty(n.prototype,"wasClean",{enumerable:!0});class X5 extends S{constructor(J,X={}){super(J);this[k4]=X.error===void 0?null:X.error,this[b4]=X.message===void 0?"":X.message}get error(){return this[k4]}get message(){return this[b4]}}Object.defineProperty(X5.prototype,"error",{enumerable:!0});Object.defineProperty(X5.prototype,"message",{enumerable:!0});class I5 extends S{constructor(J,X={}){super(J);this[p4]=X.data===void 0?null:X.data}get data(){return this[p4]}}Object.defineProperty(I5.prototype,"data",{enumerable:!0});var _J={addEventListener(J,X,Z={}){for(let K of this.listeners(J))if(!Z[J5]&&K[m5]===X&&!K[J5])return;let $;if(J==="message")$=function K(G,z){let j=new I5("message",{data:z?G:G.toString()});j[c]=this,V5(X,this,j)};else if(J==="close")$=function K(G,z){let j=new n("close",{code:G,reason:z.toString(),wasClean:this._closeFrameReceived&&this._closeFrameSent});j[c]=this,V5(X,this,j)};else if(J==="error")$=function K(G){let z=new X5("error",{error:G,message:G.message});z[c]=this,V5(X,this,z)};else if(J==="open")$=function K(){let G=new S("open");G[c]=this,V5(X,this,G)};else return;if($[J5]=!!Z[J5],$[m5]=X,Z.once)this.once(J,$);else this.on(J,$)},removeEventListener(J,X){for(let Z of this.listeners(J))if(Z[m5]===X&&!Z[J5]){this.removeListener(J,Z);break}}};n4.exports={CloseEvent:n,ErrorEvent:X5,Event:S,EventTarget:_J,MessageEvent:I5};function V5(J,X,Z){if(typeof J==="object"&&J.handleEvent)J.handleEvent.call(J,Z);else J.call(X,Z)}});var f5=F((TX,a4)=>{var{tokenChars:Z5}=b();function q(J,X,Z){if(J[X]===void 0)J[X]=[Z];else J[X].push(Z)}function HJ(J){let X=Object.create(null),Z=Object.create(null),$=!1,K=!1,G=!1,z,j,Q=-1,I=-1,_=-1,Y=0;for(;Y<J.length;Y++)if(I=J.charCodeAt(Y),z===void 0)if(_===-1&&Z5[I]===1){if(Q===-1)Q=Y}else if(Y!==0&&(I===32||I===9)){if(_===-1&&Q!==-1)_=Y}else if(I===59||I===44){if(Q===-1)throw new SyntaxError(`Unexpected character at index ${Y}`);if(_===-1)_=Y;let M=J.slice(Q,_);if(I===44)q(X,M,Z),Z=Object.create(null);else z=M;Q=_=-1}else throw new SyntaxError(`Unexpected character at index ${Y}`);else if(j===void 0)if(_===-1&&Z5[I]===1){if(Q===-1)Q=Y}else if(I===32||I===9){if(_===-1&&Q!==-1)_=Y}else if(I===59||I===44){if(Q===-1)throw new SyntaxError(`Unexpected character at index ${Y}`);if(_===-1)_=Y;if(q(Z,J.slice(Q,_),!0),I===44)q(X,z,Z),Z=Object.create(null),z=void 0;Q=_=-1}else if(I===61&&Q!==-1&&_===-1)j=J.slice(Q,Y),Q=_=-1;else throw new SyntaxError(`Unexpected character at index ${Y}`);else if(K){if(Z5[I]!==1)throw new SyntaxError(`Unexpected character at index ${Y}`);if(Q===-1)Q=Y;else if(!$)$=!0;K=!1}else if(G)if(Z5[I]===1){if(Q===-1)Q=Y}else if(I===34&&Q!==-1)G=!1,_=Y;else if(I===92)K=!0;else throw new SyntaxError(`Unexpected character at index ${Y}`);else if(I===34&&J.charCodeAt(Y-1)===61)G=!0;else if(_===-1&&Z5[I]===1){if(Q===-1)Q=Y}else if(Q!==-1&&(I===32||I===9)){if(_===-1)_=Y}else if(I===59||I===44){if(Q===-1)throw new SyntaxError(`Unexpected character at index ${Y}`);if(_===-1)_=Y;let M=J.slice(Q,_);if($)M=M.replace(/\\/g,""),$=!1;if(q(Z,j,M),I===44)q(X,z,Z),Z=Object.create(null),z=void 0;j=void 0,Q=_=-1}else throw new SyntaxError(`Unexpected character at index ${Y}`);if(Q===-1||G||I===32||I===9)throw new SyntaxError("Unexpected end of input");if(_===-1)_=Y;let A=J.slice(Q,_);if(z===void 0)q(X,A,Z);else{if(j===void 0)q(Z,A,!0);else if($)q(Z,j,A.replace(/\\/g,""));else q(Z,j,A);q(X,z,Z)}return X}function NJ(J){return Object.keys(J).map((X)=>{let Z=J[X];if(!Array.isArray(Z))Z=[Z];return Z.map(($)=>{return[X].concat(Object.keys($).map((K)=>{let G=$[K];if(!Array.isArray(G))G=[G];return G.map((z)=>z===!0?K:`${K}=${z}`).join("; ")})).join("; ")}).join(", ")}).join(", ")}a4.exports={format:NJ,parse:HJ}});var R5=F((WX,z7)=>{var RJ=N("events"),AJ=N("https"),FJ=N("http"),t4=N("net"),DJ=N("tls"),{randomBytes:MJ,createHash:OJ}=N("crypto"),{Duplex:LX,Readable:xX}=N("stream"),{URL:u5}=N("url"),v=e(),PJ=w5(),BJ=g5(),{isBlob:CJ}=b(),{BINARY_TYPES:o4,EMPTY_BUFFER:_5,GUID:UJ,kForOnEventAttribute:l5,kListener:qJ,kStatusCode:TJ,kWebSocket:D,NOOP:e4}=T(),{EventTarget:{addEventListener:LJ,removeEventListener:xJ}}=r4(),{format:WJ,parse:yJ}=f5(),{toBuffer:EJ}=s(),J7=Symbol("kAborted"),p5=[8,13],W=["CONNECTING","OPEN","CLOSING","CLOSED"],SJ=/^[!#$%&'*+\-.0-9A-Z^_`|a-z~]+$/;class V extends RJ{constructor(J,X,Z){super();if(this._binaryType=o4[0],this._closeCode=1006,this._closeFrameReceived=!1,this._closeFrameSent=!1,this._closeMessage=_5,this._closeTimer=null,this._errorEmitted=!1,this._extensions={},this._paused=!1,this._protocol="",this._readyState=V.CONNECTING,this._receiver=null,this._sender=null,this._socket=null,J!==null){if(this._bufferedAmount=0,this._isServer=!1,this._redirects=0,X===void 0)X=[];else if(!Array.isArray(X))if(typeof X==="object"&&X!==null)Z=X,X=[];else X=[X];X7(this,J,X,Z)}else this._autoPong=Z.autoPong,this._isServer=!0}get binaryType(){return this._binaryType}set binaryType(J){if(!o4.includes(J))return;if(this._binaryType=J,this._receiver)this._receiver._binaryType=J}get bufferedAmount(){if(!this._socket)return this._bufferedAmount;return this._socket._writableState.length+this._sender._bufferedBytes}get extensions(){return Object.keys(this._extensions).join()}get isPaused(){return this._paused}get onclose(){return null}get onerror(){return null}get onopen(){return null}get onmessage(){return null}get protocol(){return this._protocol}get readyState(){return this._readyState}get url(){return this._url}setSocket(J,X,Z){let $=new PJ({allowSynchronousEvents:Z.allowSynchronousEvents,binaryType:this.binaryType,extensions:this._extensions,isServer:this._isServer,maxPayload:Z.maxPayload,skipUTF8Validation:Z.skipUTF8Validation}),K=new BJ(J,this._extensions,Z.generateMask);if(this._receiver=$,this._sender=K,this._socket=J,$[D]=this,K[D]=this,J[D]=this,$.on("conclude",hJ),$.on("drain",gJ),$.on("error",mJ),$.on("message",fJ),$.on("ping",uJ),$.on("pong",lJ),K.onerror=pJ,J.setTimeout)J.setTimeout(0);if(J.setNoDelay)J.setNoDelay();if(X.length>0)J.unshift(X);J.on("close",K7),J.on("data",N5),J.on("end",G7),J.on("error",Q7),this._readyState=V.OPEN,this.emit("open")}emitClose(){if(!this._socket){this._readyState=V.CLOSED,this.emit("close",this._closeCode,this._closeMessage);return}if(this._extensions[v.extensionName])this._extensions[v.extensionName].cleanup();this._receiver.removeAllListeners(),this._readyState=V.CLOSED,this.emit("close",this._closeCode,this._closeMessage)}close(J,X){if(this.readyState===V.CLOSED)return;if(this.readyState===V.CONNECTING){P(this,this._req,"WebSocket was closed before the connection was established");return}if(this.readyState===V.CLOSING){if(this._closeFrameSent&&(this._closeFrameReceived||this._receiver._writableState.errorEmitted))this._socket.end();return}this._readyState=V.CLOSING,this._sender.close(J,X,!this._isServer,(Z)=>{if(Z)return;if(this._closeFrameSent=!0,this._closeFrameReceived||this._receiver._writableState.errorEmitted)this._socket.end()}),$7(this)}pause(){if(this.readyState===V.CONNECTING||this.readyState===V.CLOSED)return;this._paused=!0,this._socket.pause()}ping(J,X,Z){if(this.readyState===V.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");if(typeof J==="function")Z=J,J=X=void 0;else if(typeof X==="function")Z=X,X=void 0;if(typeof J==="number")J=J.toString();if(this.readyState!==V.OPEN){k5(this,J,Z);return}if(X===void 0)X=!this._isServer;this._sender.ping(J||_5,X,Z)}pong(J,X,Z){if(this.readyState===V.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");if(typeof J==="function")Z=J,J=X=void 0;else if(typeof X==="function")Z=X,X=void 0;if(typeof J==="number")J=J.toString();if(this.readyState!==V.OPEN){k5(this,J,Z);return}if(X===void 0)X=!this._isServer;this._sender.pong(J||_5,X,Z)}resume(){if(this.readyState===V.CONNECTING||this.readyState===V.CLOSED)return;if(this._paused=!1,!this._receiver._writableState.needDrain)this._socket.resume()}send(J,X,Z){if(this.readyState===V.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");if(typeof X==="function")Z=X,X={};if(typeof J==="number")J=J.toString();if(this.readyState!==V.OPEN){k5(this,J,Z);return}let $={binary:typeof J!=="string",mask:!this._isServer,compress:!0,fin:!0,...X};if(!this._extensions[v.extensionName])$.compress=!1;this._sender.send(J||_5,$,Z)}terminate(){if(this.readyState===V.CLOSED)return;if(this.readyState===V.CONNECTING){P(this,this._req,"WebSocket was closed before the connection was established");return}if(this._socket)this._readyState=V.CLOSING,this._socket.destroy()}}Object.defineProperty(V,"CONNECTING",{enumerable:!0,value:W.indexOf("CONNECTING")});Object.defineProperty(V.prototype,"CONNECTING",{enumerable:!0,value:W.indexOf("CONNECTING")});Object.defineProperty(V,"OPEN",{enumerable:!0,value:W.indexOf("OPEN")});Object.defineProperty(V.prototype,"OPEN",{enumerable:!0,value:W.indexOf("OPEN")});Object.defineProperty(V,"CLOSING",{enumerable:!0,value:W.indexOf("CLOSING")});Object.defineProperty(V.prototype,"CLOSING",{enumerable:!0,value:W.indexOf("CLOSING")});Object.defineProperty(V,"CLOSED",{enumerable:!0,value:W.indexOf("CLOSED")});Object.defineProperty(V.prototype,"CLOSED",{enumerable:!0,value:W.indexOf("CLOSED")});["binaryType","bufferedAmount","extensions","isPaused","protocol","readyState","url"].forEach((J)=>{Object.defineProperty(V.prototype,J,{enumerable:!0})});["open","error","close","message"].forEach((J)=>{Object.defineProperty(V.prototype,`on${J}`,{enumerable:!0,get(){for(let X of this.listeners(J))if(X[l5])return X[qJ];return null},set(X){for(let Z of this.listeners(J))if(Z[l5]){this.removeListener(J,Z);break}if(typeof X!=="function")return;this.addEventListener(J,X,{[l5]:!0})}})});V.prototype.addEventListener=LJ;V.prototype.removeEventListener=xJ;z7.exports=V;function X7(J,X,Z,$){let K={allowSynchronousEvents:!0,autoPong:!0,protocolVersion:p5[1],maxPayload:104857600,skipUTF8Validation:!1,perMessageDeflate:!0,followRedirects:!1,maxRedirects:10,...$,socketPath:void 0,hostname:void 0,protocol:void 0,timeout:void 0,method:"GET",host:void 0,path:void 0,port:void 0};if(J._autoPong=K.autoPong,!p5.includes(K.protocolVersion))throw new RangeError(`Unsupported protocol version: ${K.protocolVersion} (supported versions: ${p5.join(", ")})`);let G;if(X instanceof u5)G=X;else try{G=new u5(X)}catch(H){throw new SyntaxError(`Invalid URL: ${X}`)}if(G.protocol==="http:")G.protocol="ws:";else if(G.protocol==="https:")G.protocol="wss:";J._url=G.href;let z=G.protocol==="wss:",j=G.protocol==="ws+unix:",Q;if(G.protocol!=="ws:"&&!z&&!j)Q=`The URL's protocol must be one of "ws:", "wss:", "http:", "https:", or "ws+unix:"`;else if(j&&!G.pathname)Q="The URL's pathname is empty";else if(G.hash)Q="The URL contains a fragment identifier";if(Q){let H=new SyntaxError(Q);if(J._redirects===0)throw H;else{H5(J,H);return}}let I=z?443:80,_=MJ(16).toString("base64"),Y=z?AJ.request:FJ.request,A=new Set,M;if(K.createConnection=K.createConnection||(z?wJ:vJ),K.defaultPort=K.defaultPort||I,K.port=G.port||I,K.host=G.hostname.startsWith("[")?G.hostname.slice(1,-1):G.hostname,K.headers={...K.headers,"Sec-WebSocket-Version":K.protocolVersion,"Sec-WebSocket-Key":_,Connection:"Upgrade",Upgrade:"websocket"},K.path=G.pathname+G.search,K.timeout=K.handshakeTimeout,K.perMessageDeflate)M=new v(K.perMessageDeflate!==!0?K.perMessageDeflate:{},!1,K.maxPayload),K.headers["Sec-WebSocket-Extensions"]=WJ({[v.extensionName]:M.offer()});if(Z.length){for(let H of Z){if(typeof H!=="string"||!SJ.test(H)||A.has(H))throw new SyntaxError("An invalid or duplicated subprotocol was specified");A.add(H)}K.headers["Sec-WebSocket-Protocol"]=Z.join(",")}if(K.origin)if(K.protocolVersion<13)K.headers["Sec-WebSocket-Origin"]=K.origin;else K.headers.Origin=K.origin;if(G.username||G.password)K.auth=`${G.username}:${G.password}`;if(j){let H=K.path.split(":");K.socketPath=H[0],K.path=H[1]}let R;if(K.followRedirects){if(J._redirects===0){J._originalIpc=j,J._originalSecure=z,J._originalHostOrSocketPath=j?K.socketPath:G.host;let H=$&&$.headers;if($={...$,headers:{}},H)for(let[O,u]of Object.entries(H))$.headers[O.toLowerCase()]=u}else if(J.listenerCount("redirect")===0){let H=j?J._originalIpc?K.socketPath===J._originalHostOrSocketPath:!1:J._originalIpc?!1:G.host===J._originalHostOrSocketPath;if(!H||J._originalSecure&&!z){if(delete K.headers.authorization,delete K.headers.cookie,!H)delete K.headers.host;K.auth=void 0}}if(K.auth&&!$.headers.authorization)$.headers.authorization="Basic "+Buffer.from(K.auth).toString("base64");if(R=J._req=Y(K),J._redirects)J.emit("redirect",J.url,R)}else R=J._req=Y(K);if(K.timeout)R.on("timeout",()=>{P(J,R,"Opening handshake has timed out")});if(R.on("error",(H)=>{if(R===null||R[J7])return;R=J._req=null,H5(J,H)}),R.on("response",(H)=>{let O=H.headers.location,u=H.statusCode;if(O&&K.followRedirects&&u>=300&&u<400){if(++J._redirects>K.maxRedirects){P(J,R,"Maximum redirects exceeded");return}R.abort();let r;try{r=new u5(O,X)}catch(i5){let l=new SyntaxError(`Invalid URL: ${O}`);H5(J,l);return}X7(J,r,Z,$)}else if(!J.emit("unexpected-response",R,H))P(J,R,`Unexpected server response: ${H.statusCode}`)}),R.on("upgrade",(H,O,u)=>{if(J.emit("upgrade",H),J.readyState!==V.CONNECTING)return;R=J._req=null;let r=H.headers.upgrade;if(r===void 0||r.toLowerCase()!=="websocket"){P(J,O,"Invalid Upgrade header");return}let i5=OJ("sha1").update(_+UJ).digest("base64");if(H.headers["sec-websocket-accept"]!==i5){P(J,O,"Invalid Sec-WebSocket-Accept header");return}let l=H.headers["sec-websocket-protocol"],a;if(l!==void 0){if(!A.size)a="Server sent a subprotocol but none was requested";else if(!A.has(l))a="Server sent an invalid subprotocol"}else if(A.size)a="Server sent no subprotocol";if(a){P(J,O,a);return}if(l)J._protocol=l;let c5=H.headers["sec-websocket-extensions"];if(c5!==void 0){if(!M){P(J,O,"Server sent a Sec-WebSocket-Extensions header but no extension was requested");return}let F5;try{F5=yJ(c5)}catch(D5){P(J,O,"Invalid Sec-WebSocket-Extensions header");return}let n5=Object.keys(F5);if(n5.length!==1||n5[0]!==v.extensionName){P(J,O,"Server indicated an extension that was not requested");return}try{M.accept(F5[v.extensionName])}catch(D5){P(J,O,"Invalid Sec-WebSocket-Extensions header");return}J._extensions[v.extensionName]=M}J.setSocket(O,u,{allowSynchronousEvents:K.allowSynchronousEvents,generateMask:K.generateMask,maxPayload:K.maxPayload,skipUTF8Validation:K.skipUTF8Validation})}),K.finishRequest)K.finishRequest(R,J);else R.end()}function H5(J,X){J._readyState=V.CLOSING,J._errorEmitted=!0,J.emit("error",X),J.emitClose()}function vJ(J){return J.path=J.socketPath,t4.connect(J)}function wJ(J){if(J.path=void 0,!J.servername&&J.servername!=="")J.servername=t4.isIP(J.host)?"":J.host;return DJ.connect(J)}function P(J,X,Z){J._readyState=V.CLOSING;let $=new Error(Z);if(Error.captureStackTrace($,P),X.setHeader){if(X[J7]=!0,X.abort(),X.socket&&!X.socket.destroyed)X.socket.destroy();process.nextTick(H5,J,$)}else X.destroy($),X.once("error",J.emit.bind(J,"error")),X.once("close",J.emitClose.bind(J))}function k5(J,X,Z){if(X){let $=CJ(X)?X.size:EJ(X).length;if(J._socket)J._sender._bufferedBytes+=$;else J._bufferedAmount+=$}if(Z){let $=new Error(`WebSocket is not open: readyState ${J.readyState} (${W[J.readyState]})`);process.nextTick(Z,$)}}function hJ(J,X){let Z=this[D];if(Z._closeFrameReceived=!0,Z._closeMessage=X,Z._closeCode=J,Z._socket[D]===void 0)return;if(Z._socket.removeListener("data",N5),process.nextTick(Z7,Z._socket),J===1005)Z.close();else Z.close(J,X)}function gJ(){let J=this[D];if(!J.isPaused)J._socket.resume()}function mJ(J){let X=this[D];if(X._socket[D]!==void 0)X._socket.removeListener("data",N5),process.nextTick(Z7,X._socket),X.close(J[TJ]);if(!X._errorEmitted)X._errorEmitted=!0,X.emit("error",J)}function s4(){this[D].emitClose()}function fJ(J,X){this[D].emit("message",J,X)}function uJ(J){let X=this[D];if(X._autoPong)X.pong(J,!this._isServer,e4);X.emit("ping",J)}function lJ(J){this[D].emit("pong",J)}function Z7(J){J.resume()}function pJ(J){let X=this[D];if(X.readyState===V.CLOSED)return;if(X.readyState===V.OPEN)X._readyState=V.CLOSING,$7(X);if(this._socket.end(),!X._errorEmitted)X._errorEmitted=!0,X.emit("error",J)}function $7(J){J._closeTimer=setTimeout(J._socket.destroy.bind(J._socket),30000)}function K7(){let J=this[D];this.removeListener("close",K7),this.removeListener("data",N5),this.removeListener("end",G7),J._readyState=V.CLOSING;let X;if(!this._readableState.endEmitted&&!J._closeFrameReceived&&!J._receiver._writableState.errorEmitted&&(X=J._socket.read())!==null)J._receiver.write(X);if(J._receiver.end(),this[D]=void 0,clearTimeout(J._closeTimer),J._receiver._writableState.finished||J._receiver._writableState.errorEmitted)J.emitClose();else J._receiver.on("error",s4),J._receiver.on("finish",s4)}function N5(J){if(!this[D]._receiver.write(J))this.pause()}function G7(){let J=this[D];J._readyState=V.CLOSING,J._receiver.end(),this.end()}function Q7(){let J=this[D];if(this.removeListener("error",Q7),this.on("error",e4),J)J._readyState=V.CLOSING,this.destroy()}});var I7=F((EX,V7)=>{var yX=R5(),{Duplex:kJ}=N("stream");function j7(J){J.emit("close")}function bJ(){if(!this.destroyed&&this._writableState.finished)this.destroy()}function Y7(J){if(this.removeListener("error",Y7),this.destroy(),this.listenerCount("error")===0)this.emit("error",J)}function dJ(J,X){let Z=!0,$=new kJ({...X,autoDestroy:!1,emitClose:!1,objectMode:!1,writableObjectMode:!1});return J.on("message",function K(G,z){let j=!z&&$._readableState.objectMode?G.toString():G;if(!$.push(j))J.pause()}),J.once("error",function K(G){if($.destroyed)return;Z=!1,$.destroy(G)}),J.once("close",function K(){if($.destroyed)return;$.push(null)}),$._destroy=function(K,G){if(J.readyState===J.CLOSED){G(K),process.nextTick(j7,$);return}let z=!1;if(J.once("error",function j(Q){z=!0,G(Q)}),J.once("close",function j(){if(!z)G(K);process.nextTick(j7,$)}),Z)J.terminate()},$._final=function(K){if(J.readyState===J.CONNECTING){J.once("open",function G(){$._final(K)});return}if(J._socket===null)return;if(J._socket._writableState.finished){if(K(),$._readableState.endEmitted)$.destroy()}else J._socket.once("finish",function G(){K()}),J.close()},$._read=function(){if(J.isPaused)J.resume()},$._write=function(K,G,z){if(J.readyState===J.CONNECTING){J.once("open",function j(){$._write(K,G,z)});return}J.send(K,z)},$.on("end",bJ),$.on("error",Y7),$}V7.exports=dJ});var H7=F((SX,_7)=>{var{tokenChars:iJ}=b();function cJ(J){let X=new Set,Z=-1,$=-1,K=0;for(K;K<J.length;K++){let z=J.charCodeAt(K);if($===-1&&iJ[z]===1){if(Z===-1)Z=K}else if(K!==0&&(z===32||z===9)){if($===-1&&Z!==-1)$=K}else if(z===44){if(Z===-1)throw new SyntaxError(`Unexpected character at index ${K}`);if($===-1)$=K;let j=J.slice(Z,$);if(X.has(j))throw new SyntaxError(`The "${j}" subprotocol is duplicated`);X.add(j),Z=$=-1}else throw new SyntaxError(`Unexpected character at index ${K}`)}if(Z===-1||$!==-1)throw new SyntaxError("Unexpected end of input");let G=J.slice(Z,K);if(X.has(G))throw new SyntaxError(`The "${G}" subprotocol is duplicated`);return X.add(G),X}_7.exports={parse:cJ}});var D7=F((wX,F7)=>{var nJ=N("events"),A5=N("http"),{Duplex:vX}=N("stream"),{createHash:rJ}=N("crypto"),N7=f5(),g=e(),aJ=H7(),oJ=R5(),{GUID:sJ,kWebSocket:tJ}=T(),eJ=/^[+/0-9A-Za-z]{22}==$/;class A7 extends nJ{constructor(J,X){super();if(J={allowSynchronousEvents:!0,autoPong:!0,maxPayload:104857600,skipUTF8Validation:!1,perMessageDeflate:!1,handleProtocols:null,clientTracking:!0,verifyClient:null,noServer:!1,backlog:null,server:null,host:null,path:null,port:null,WebSocket:oJ,...J},J.port==null&&!J.server&&!J.noServer||J.port!=null&&(J.server||J.noServer)||J.server&&J.noServer)throw new TypeError('One and only one of the "port", "server", or "noServer" options must be specified');if(J.port!=null)this._server=A5.createServer((Z,$)=>{let K=A5.STATUS_CODES[426];$.writeHead(426,{"Content-Length":K.length,"Content-Type":"text/plain"}),$.end(K)}),this._server.listen(J.port,J.host,J.backlog,X);else if(J.server)this._server=J.server;if(this._server){let Z=this.emit.bind(this,"connection");this._removeListeners=JX(this._server,{listening:this.emit.bind(this,"listening"),error:this.emit.bind(this,"error"),upgrade:($,K,G)=>{this.handleUpgrade($,K,G,Z)}})}if(J.perMessageDeflate===!0)J.perMessageDeflate={};if(J.clientTracking)this.clients=new Set,this._shouldEmitClose=!1;this.options=J,this._state=0}address(){if(this.options.noServer)throw new Error('The server is operating in "noServer" mode');if(!this._server)return null;return this._server.address()}close(J){if(this._state===2){if(J)this.once("close",()=>{J(new Error("The server is not running"))});process.nextTick($5,this);return}if(J)this.once("close",J);if(this._state===1)return;if(this._state=1,this.options.noServer||this.options.server){if(this._server)this._removeListeners(),this._removeListeners=this._server=null;if(this.clients)if(!this.clients.size)process.nextTick($5,this);else this._shouldEmitClose=!0;else process.nextTick($5,this)}else{let X=this._server;this._removeListeners(),this._removeListeners=this._server=null,X.close(()=>{$5(this)})}}shouldHandle(J){if(this.options.path){let X=J.url.indexOf("?");if((X!==-1?J.url.slice(0,X):J.url)!==this.options.path)return!1}return!0}handleUpgrade(J,X,Z,$){X.on("error",R7);let K=J.headers["sec-websocket-key"],G=J.headers.upgrade,z=+J.headers["sec-websocket-version"];if(J.method!=="GET"){m(this,J,X,405,"Invalid HTTP method");return}if(G===void 0||G.toLowerCase()!=="websocket"){m(this,J,X,400,"Invalid Upgrade header");return}if(K===void 0||!eJ.test(K)){m(this,J,X,400,"Missing or invalid Sec-WebSocket-Key header");return}if(z!==8&&z!==13){m(this,J,X,400,"Missing or invalid Sec-WebSocket-Version header");return}if(!this.shouldHandle(J)){K5(X,400);return}let j=J.headers["sec-websocket-protocol"],Q=new Set;if(j!==void 0)try{Q=aJ.parse(j)}catch(Y){m(this,J,X,400,"Invalid Sec-WebSocket-Protocol header");return}let I=J.headers["sec-websocket-extensions"],_={};if(this.options.perMessageDeflate&&I!==void 0){let Y=new g(this.options.perMessageDeflate,!0,this.options.maxPayload);try{let A=N7.parse(I);if(A[g.extensionName])Y.accept(A[g.extensionName]),_[g.extensionName]=Y}catch(A){m(this,J,X,400,"Invalid or unacceptable Sec-WebSocket-Extensions header");return}}if(this.options.verifyClient){let Y={origin:J.headers[`${z===8?"sec-websocket-origin":"origin"}`],secure:!!(J.socket.authorized||J.socket.encrypted),req:J};if(this.options.verifyClient.length===2){this.options.verifyClient(Y,(A,M,R,H)=>{if(!A)return K5(X,M||401,R,H);this.completeUpgrade(_,K,Q,J,X,Z,$)});return}if(!this.options.verifyClient(Y))return K5(X,401)}this.completeUpgrade(_,K,Q,J,X,Z,$)}completeUpgrade(J,X,Z,$,K,G,z){if(!K.readable||!K.writable)return K.destroy();if(K[tJ])throw new Error("server.handleUpgrade() was called more than once with the same socket, possibly due to a misconfiguration");if(this._state>0)return K5(K,503);let Q=["HTTP/1.1 101 Switching Protocols","Upgrade: websocket","Connection: Upgrade",`Sec-WebSocket-Accept: ${rJ("sha1").update(X+sJ).digest("base64")}`],I=new this.options.WebSocket(null,void 0,this.options);if(Z.size){let _=this.options.handleProtocols?this.options.handleProtocols(Z,$):Z.values().next().value;if(_)Q.push(`Sec-WebSocket-Protocol: ${_}`),I._protocol=_}if(J[g.extensionName]){let _=J[g.extensionName].params,Y=N7.format({[g.extensionName]:[_]});Q.push(`Sec-WebSocket-Extensions: ${Y}`),I._extensions=J}if(this.emit("headers",Q,$),K.write(Q.concat(`\r
`).join(`\r
`)),K.removeListener("error",R7),I.setSocket(K,G,{allowSynchronousEvents:this.options.allowSynchronousEvents,maxPayload:this.options.maxPayload,skipUTF8Validation:this.options.skipUTF8Validation}),this.clients)this.clients.add(I),I.on("close",()=>{if(this.clients.delete(I),this._shouldEmitClose&&!this.clients.size)process.nextTick($5,this)});z(I,$)}}F7.exports=A7;function JX(J,X){for(let Z of Object.keys(X))J.on(Z,X[Z]);return function Z(){for(let $ of Object.keys(X))J.removeListener($,X[$])}}function $5(J){J._state=2,J.emit("close")}function R7(){this.destroy()}function K5(J,X,Z,$){Z=Z||A5.STATUS_CODES[X],$={Connection:"close","Content-Type":"text/html","Content-Length":Buffer.byteLength(Z),...$},J.once("finish",J.destroy),J.end(`HTTP/1.1 ${X} ${A5.STATUS_CODES[X]}\r
`+Object.keys($).map((K)=>`${K}: ${$[K]}`).join(`\r
`)+`\r
\r
`+Z)}function m(J,X,Z,$,K){if(J.listenerCount("wsClientError")){let G=new Error(K);Error.captureStackTrace(G,m),J.emit("wsClientError",G,Z,X)}else K5(Z,$,K)}});import KX from"http";var XX=o(I7(),1),ZX=o(w5(),1),$X=o(g5(),1),M7=o(R5(),1),b5=o(D7(),1);var d5=M7.default;var O7=process.env.PORT,B7=KX.createServer(),GX=new b5.default({server:B7}),f=new Map;GX.on("connection",(J)=>{console.log("CONNECTION");let X=crypto.randomUUID();f.set(J,X),J.on("message",(Z)=>{let $=JSON.parse(Z.toString());if($.type==="ready"){if($.id!==null)f.set(J,X);J.send(JSON.stringify({type:"init",id:X,peers:QX(X)})),P7(J,{type:"new-user",id:X});return}if($.from=X,$.to!==void 0){let K=[...f.entries()].find(([,G])=>G===$.to)?.[0];if(K&&K.readyState===d5.OPEN)K.send(JSON.stringify($))}}),J.on("close",()=>{console.log("fechou");let Z=f.get(J);P7(J,{type:"close",id:Z}),f.delete(J)})});function QX(J){return Array.from(f.values()).filter((Z)=>Z!==J)}function P7(J,X){for(let[Z]of f.entries())if(Z!==J&&Z.readyState===d5.OPEN)Z.send(JSON.stringify(X))}B7.listen(O7,()=>{console.log(`Servidor rodando em ${O7}`)});
